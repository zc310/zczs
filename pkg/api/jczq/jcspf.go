package jczq

import (
	"encoding/json"
	"time"

	"github.com/valyala/fasthttp"
	"github.com/zc310/zczs/pkg"
)

func HandlerIssue(ctx *fasthttp.RequestCtx) {

	// {"c":"20190626","l":["20190626","20190619","20190618","20190617","20190616","20190615","20190614","20190613","20190612","20190611","20190610","20190609","20190608","20190607","20190606","20190605","20190604","20190603","20190602","20190601","20190531","20190530","20190529","20190528","20190527","20190526","20190525","20190524","20190523","20190522","20190521","20190520","20190519","20190518","20190517","20190516","20190515","20190514","20190513","20190512","20190511","20190510","20190509","20190508","20190507","20190506","20190505","20190504","20190503","20190502","20190501","20190430","20190429","20190428","20190427","20190426","20190425","20190424","20190423","20190422","20190421","20190420","20190419","20190418","20190417","20190416","20190415","20190410","20190409","20190408","20190407","20190406","20190405","20190404","20190403","20190402","20190401","20190331","20190330","20190329","20190327","20190326","20190325","20190324","20190323","20190322","20190321","20190318","20190317","20190316","20190315","20190314","20190313","20190312","20190311","20190310","20190309","20190308","20190307","20190306"]}

	var q pkg.Issue

	tm1 := time.Now()

	for i := 0; i < 30; i++ {
		if i == 0 {
			q.C = tm1.Format("20060102")
		}
		q.L = append(q.L, tm1.Format("20060102"))
		tm1 = tm1.AddDate(0, 0, 1)
	}

	b, err := json.Marshal(q)
	if err != nil {
		return
	}
	_, _ = ctx.Write(b)
}
